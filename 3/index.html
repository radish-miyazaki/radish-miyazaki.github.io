<!DOCTYPE html>
<html lang="ja-jp">
  <head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ruby Null Object | method_missing(*)</title>
  <link rel="stylesheet" href="https://radish-miyazaki.github.io/assets/css/post.css" />
  <script defer src="https://radish-miyazaki.github.io/assets/js/lbox.js"></script>
  
  <link rel="stylesheet" href="https://radish-miyazaki.github.io/assets/css/common.css" />
  <link rel="icon" type="image/png" href="https://radish-miyazaki.github.io/assets/icons/ruby.png" />
  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://radish-miyazaki.github.io/post-cover.png"/>

<meta name="twitter:title" content="Ruby Null Object"/>
<meta name="twitter:description" content="Null Objectとは Null Objectとは、「何もしないメソッド」を持つオブジェクトのこと。
クラスベースのオブジェクト指向言語（Java, C#など）だと時折見かける。
class Huga def huga &#39;huga&#39; end end class NullHuga def huga; end end class Hoge def process_huga(huga) # create_hugaはhuga or nullを返す設定 create_huga || NullHuga.new end end	Null Objectのメソッドを呼び出すと、エラーを出さずにメッセージをゴミ箱に捨ててくれる。"/>

  <meta property="og:title" content="Ruby Null Object" />
<meta property="og:description" content="Null Objectとは Null Objectとは、「何もしないメソッド」を持つオブジェクトのこと。
クラスベースのオブジェクト指向言語（Java, C#など）だと時折見かける。
class Huga def huga &#39;huga&#39; end end class NullHuga def huga; end end class Hoge def process_huga(huga) # create_hugaはhuga or nullを返す設定 create_huga || NullHuga.new end end	Null Objectのメソッドを呼び出すと、エラーを出さずにメッセージをゴミ箱に捨ててくれる。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://radish-miyazaki.github.io/3/" /><meta property="og:image" content="https://radish-miyazaki.github.io/post-cover.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-18T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-02-18T00:00:00+00:00" />


</head>
  <body>
    <main>
      <header>
  <a class="site-title" href="https://radish-miyazaki.github.io">method_missing(*)</a>
</header>

      <section class="article">
        <div class="article-header">
          <h2 class="article-title">Ruby Null Object</h2>
          <small class="date">2022-02-18 (Fri)</small>
          <div class="tags">
            
            <a href="https://radish-miyazaki.github.io/tags/ruby" class="tag">ruby</a>
            
          </div>
        </div>
        <div class="content"><h2 id="null-objectとは">Null Objectとは</h2>
<p>Null Objectとは、「<strong>何もしないメソッド</strong>」を持つオブジェクトのこと。</p>
<p>クラスベースのオブジェクト指向言語（Java, C#など）だと時折見かける。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Huga</span>
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">huga</span>
    <span style="color:#e6db74">&#39;huga&#39;</span>
  <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NullHuga</span>
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">huga</span>; <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Hoge</span>
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">process_huga</span>(huga)
    <span style="color:#75715e"># create_hugaはhuga or nullを返す設定</span>
    create_huga <span style="color:#f92672">||</span> <span style="color:#66d9ef">NullHuga</span><span style="color:#f92672">.</span>new
  <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>	
</code></pre></div><p>Null Objectのメソッドを呼び出すと、エラーを出さずにメッセージをゴミ箱に捨ててくれる。</p>
<p>つまり、初期化されていない参照をNull Objectで置換すると、<code>NoMethodError</code><strong>を起こさなくて済む</strong>。</p>
<p>これにより、いちいち既存の処理に<code>if</code>チェックを入れなくても済む。</p>
<h2 id="moduleを応用してみる">moduleを応用してみる</h2>
<p>対象となるクラスとNull Objectクラス間で共通のメソッドを持つようにするため、Interfaceのようなモジュールを持たせてみる。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#75715e"># 専用のエラーを作っておく</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">InterfaceError</span> <span style="color:#f92672">&lt;</span> <span style="color:#66d9ef">StandardError</span>; <span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">module</span> HogeInterface
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hoge</span>
    <span style="color:#66d9ef">raise</span> <span style="color:#66d9ef">InterfaceError</span>
  <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Hoge</span>
  <span style="color:#66d9ef">include</span> <span style="color:#66d9ef">HogeInterface</span>
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hoge</span>
    <span style="color:#e6db74">&#39;hoge&#39;</span>
  <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NullHoge</span>
  <span style="color:#66d9ef">include</span> <span style="color:#66d9ef">HogeInterface</span>
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hoge</span>; <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>
</code></pre></div><p>これで、Interfaceモジュールに先にメソッド定義するよう心がければ、抜け漏れが減るかも？</p>
<h3 id="参考書籍">参考書籍</h3>
<p><a href="https://www.amazon.co.jp/%E3%83%A1%E3%82%BF%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0Ruby-%E7%AC%AC2%E7%89%88-Paolo-Perrotta/dp/4873117437">メタプログラミングRuby 第2版</a></p>
</div>
      </section>
      <footer>
  <p>&copy; 2024 Radish All rights reserved. </p>
</footer>
    </main>
  </body>
</html>
